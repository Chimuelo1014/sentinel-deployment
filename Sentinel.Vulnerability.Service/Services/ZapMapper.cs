using Sentinel.Vulnerability.Service.Models;

namespace Sentinel.Vulnerability.Service.Services
{
    public class ZapMapper
    {
        public List<VulnerabilityFinding> Map(ZapRawOutput raw)
        {
            return raw.Site
                .SelectMany(s => s.Alerts)
                .Select(a => new VulnerabilityFinding
                {
                    Id = a.Alert.Replace(" ", "_").ToUpper(),
                    Title = a.Alert,
                    Description = a.Description,
                    Severity = a.Risk,
                    Source = "ZAP"
                })
                .ToList();
        }
    }
}