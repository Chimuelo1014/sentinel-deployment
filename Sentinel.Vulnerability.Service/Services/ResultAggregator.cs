using Sentinel.Vulnerability.Service.Models;

namespace Sentinel.Vulnerability.Service.Services
{
    public class ResultAggregator
    {
        private readonly Dictionary<string, ScanResult> _cache = new();

        public ScanResult AddPartialResult(string scanId, string projectName, List<VulnerabilityFinding> findings)
        {
            if (!_cache.ContainsKey(scanId))
            {
                _cache[scanId] = new ScanResult
                {
                    ScanId = scanId,
                    ProjectName = projectName,
                    Findings = new()
                };
            }

            _cache[scanId].Findings.AddRange(findings);

            return _cache[scanId];
        }
    }
}